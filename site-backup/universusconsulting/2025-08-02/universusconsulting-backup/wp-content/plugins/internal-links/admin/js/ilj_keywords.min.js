!function(e){e.fn.ilj_keywords=function(i){var r=this,t=e.extend({inputField:"",errorMessage:"",duplicate_notice:"",requiresPro:!1,sortable:!0},i),s={width:"",maxWidth:"200",useTitle:!0,delay:100,speed:500,background:"#32373c",color:"#eeeeee",size:"small"};({keywords:[],init:function(){var i=this;return t.sortable&&r.find("ul.keyword-view").sortable({opacity:.5,helper:"clone",forceHelperSize:!0,forcePlaceholderSize:!0,cursor:"move",placeholder:"placeholder",update:function(e,r){i.reorderKeywords()}}),r.find("ul.keyword-view").disableSelection(),r.find(".tip").iljtipso(s),r.on("keypress","input.keywordInput",(function(e){return 13===e.keyCode&&r.find("a.add-keyword").click(),13!=e.keyCode})),r.on("click","a.add-keyword",(function(r){r.preventDefault();var t=e(this).siblings("input.keywordInput"),s=null,a=new URLSearchParams(window.location.search);if("true"===e(this).attr("blacklist-keyword")&&!0,e("#post_ID").length?(e("#post_ID").val(),"ilj_customlinks"!==(s=e("#post_type").val())?"post":s):a.get("tag_ID")&&(a.get("tag_ID"),s=a.get("taxonomy"),"term"),-1!==t.val().indexOf(",")){t.val().split(",").forEach((function(e,r){keyword_value=i.sanitizeKeyword(e),valid=i.validateKeyword(keyword_value),valid.is_valid&&i.addKeyword(keyword_value)}))}else{if(keyword_value=i.sanitizeKeyword(t.val()),valid=i.validateKeyword(keyword_value),!valid.is_valid)return void i.setError(valid.message);i.addKeyword(keyword_value)}t.val(""),i.clearError(),i.syncGui(),i.syncField()})),this.initKeywords(),this.syncGui(),r.on("click",".keyword a.remove",(function(r){r.preventDefault();var t=e(this).parent(".keyword").data("id");i.keywords.splice(t,1),i.syncGui(),i.syncField()})),this.keywords},initKeywords:function(){that=this;var i=e("<textarea/>").text(t.inputField.val()).html();""!=i&&null!=i&&i.split(",").forEach((function(e,i){that.addKeyword(e)}))},addKeyword:function(e){that=this,this.keywords.push(e)},sanitizeKeyword:function(e){return e.replace(/\s*\{\s*/gu," {").replace(/\s*\}\s*/gu,"} ").replace(/\s{2,}/gu," ").replace(/^\s+|\s+$/gu,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},validateKeyword:function(e){for(var i={is_valid:!1,message:"Unknown error"},r=e.replace(/\{.*?\}/gu,"").replace(/\s/gu,""),s=0;s<this.keywords.length;s++)if(e.toLowerCase()==this.keywords[s].toLowerCase())return i.message=ilj_editor_translation.message_keyword_exists,i;if(""===r)return i.message=ilj_editor_translation.message_no_keyword,i;if(r.length<2)return i.message=ilj_editor_translation.message_length_not_valid,i;if(/(\s?\{[+-]*\d+\}\s?){2,}/.test(e))return i.message=ilj_editor_translation.message_multiple_placeholder,i;var a=this.keywords.length;return 1==t.requiresPro&&1==ilj_editor_basic_restriction.is_active&&a>=ilj_editor_basic_restriction.blacklist_limit?(i.message="<p>"+ilj_editor_translation.message_limited_blacklist_keyword+"</p>",i.message+="<p>"+ilj_editor_translation.message_limited_blacklist_keyword_upgrade+".</p>",i):(i.is_valid=!0,i.message="",i)},syncGui:function(){var i=this;r.find("ul.keyword-view li").remove(),this.keywords.length>0?(this.keywords.forEach((function(t,s){r.find("ul.keyword-view").append(e(i.renderKeyword(t,s)))})),r.find(".tip").iljtipso(s)):r.find("ul.keyword-view").append(e("<li>"+ilj_editor_translation.no_keywords+"</li>"))},syncField:function(){t.inputField.val(this.keywords.join(","))},renderKeyword:function(e,i){return keyword_print=e.replace(/\{(\d+)\}/g,'<span class="exact tip" title="'+ilj_editor_translation.gap_hover_exact+' $1">$1</span>').replace(/\{\-(\d+)\}/g,'<span class="max tip" title="'+ilj_editor_translation.gap_hover_max+' $1">$1</span>').replace(/\{\+(\d+)\}/g,'<span class="min tip" title="'+ilj_editor_translation.gap_hover_min+' $1">$1</span>'),'<li class="keyword" data-id="'+i+'"><a class="dashicons dashicons-dismiss remove"></a>'+keyword_print+"</li>"},reorderKeywords:function(){order=[];var i=this;return r.find("li").each((function(){var i=e(this).data("id");void 0!==i&&order.push(i)})),new_keywords=[],e.each(order,(function(e,r){new_keywords.push(i.keywords[r])})),i.keywords=new_keywords,i.syncGui(),i.syncField(),!0},setError:function(e){t.errorMessage.html(e),t.errorMessage.show()},clearError:function(){t.errorMessage.html(""),t.errorMessage.hide()}}).init()}}(jQuery);
//# sourceMappingURL=ilj_keywords.min.js.map